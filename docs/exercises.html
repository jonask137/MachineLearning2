<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>2.4 Exercises | Machine Learning for Business Intelligence 2</title>
  <meta name="description" content="2.4 Exercises | Machine Learning for Business Intelligence 2" />
  <meta name="generator" content="bookdown 0.21 and GitBook 2.6.7" />

  <meta property="og:title" content="2.4 Exercises | Machine Learning for Business Intelligence 2" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="2.4 Exercises | Machine Learning for Business Intelligence 2" />
  
  
  




  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="lab-section.html"/>
<link rel="next" href="tree-based-methods.html"/>
<script src="libs/header-attrs-2.5/header-attrs.js"></script>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<link href="libs/anchor-sections-1.0/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>setup</a></li>
<li class="chapter" data-level="1" data-path="introduction.html"><a href="introduction.html"><i class="fa fa-check"></i><b>1</b> Introduction</a></li>
<li class="chapter" data-level="2" data-path="moving-beyond-linearity.html"><a href="moving-beyond-linearity.html"><i class="fa fa-check"></i><b>2</b> Moving Beyond Linearity</a>
<ul>
<li class="chapter" data-level="2.1" data-path="models-beyond-linearity.html"><a href="models-beyond-linearity.html"><i class="fa fa-check"></i><b>2.1</b> Models Beyond Linearity</a>
<ul>
<li class="chapter" data-level="2.1.1" data-path="models-beyond-linearity.html"><a href="models-beyond-linearity.html#polynomial-regression"><i class="fa fa-check"></i><b>2.1.1</b> Polynomial Regression</a>
<ul>
<li class="chapter" data-level="2.1.1.1" data-path="models-beyond-linearity.html"><a href="models-beyond-linearity.html#beta-coefficients-and-variance"><i class="fa fa-check"></i><b>2.1.1.1</b> Beta coefficients and variance</a></li>
<li class="chapter" data-level="2.1.1.2" data-path="models-beyond-linearity.html"><a href="models-beyond-linearity.html#application-procedure"><i class="fa fa-check"></i><b>2.1.1.2</b> Application procedure</a></li>
</ul></li>
<li class="chapter" data-level="2.1.2" data-path="models-beyond-linearity.html"><a href="models-beyond-linearity.html#step-functions"><i class="fa fa-check"></i><b>2.1.2</b> Step Functions</a></li>
<li class="chapter" data-level="2.1.3" data-path="models-beyond-linearity.html"><a href="models-beyond-linearity.html#regression-splines"><i class="fa fa-check"></i><b>2.1.3</b> Regression Splines</a>
<ul>
<li class="chapter" data-level="2.1.3.1" data-path="models-beyond-linearity.html"><a href="models-beyond-linearity.html#piecewise-polynomials"><i class="fa fa-check"></i><b>2.1.3.1</b> Piecewise Polynomials</a></li>
<li class="chapter" data-level="2.1.3.2" data-path="models-beyond-linearity.html"><a href="models-beyond-linearity.html#constraints-and-splines"><i class="fa fa-check"></i><b>2.1.3.2</b> Constraints and Splines</a></li>
<li class="chapter" data-level="2.1.3.3" data-path="models-beyond-linearity.html"><a href="models-beyond-linearity.html#choosing-the-number-and-location-of-the-knots"><i class="fa fa-check"></i><b>2.1.3.3</b> Choosing the number and location of the Knots</a></li>
<li class="chapter" data-level="2.1.3.4" data-path="models-beyond-linearity.html"><a href="models-beyond-linearity.html#comparison-with-polynomial-regression"><i class="fa fa-check"></i><b>2.1.3.4</b> Comparison with Polynomial Regression</a></li>
</ul></li>
<li class="chapter" data-level="2.1.4" data-path="models-beyond-linearity.html"><a href="models-beyond-linearity.html#smoothing-splines"><i class="fa fa-check"></i><b>2.1.4</b> Smoothing Splines</a>
<ul>
<li class="chapter" data-level="2.1.4.1" data-path="models-beyond-linearity.html"><a href="models-beyond-linearity.html#choosing-optimal-tuning-parameter"><i class="fa fa-check"></i><b>2.1.4.1</b> Choosing optimal tuning parameter</a></li>
</ul></li>
<li class="chapter" data-level="2.1.5" data-path="models-beyond-linearity.html"><a href="models-beyond-linearity.html#local-regression"><i class="fa fa-check"></i><b>2.1.5</b> Local Regression</a></li>
<li class="chapter" data-level="2.1.6" data-path="models-beyond-linearity.html"><a href="models-beyond-linearity.html#generalized-additive-models"><i class="fa fa-check"></i><b>2.1.6</b> Generalized Additive Models</a>
<ul>
<li class="chapter" data-level="2.1.6.1" data-path="models-beyond-linearity.html"><a href="models-beyond-linearity.html#gam-for-regression-problems"><i class="fa fa-check"></i><b>2.1.6.1</b> GAM for regression problems</a></li>
<li class="chapter" data-level="2.1.6.2" data-path="models-beyond-linearity.html"><a href="models-beyond-linearity.html#gam-for-classification-problems"><i class="fa fa-check"></i><b>2.1.6.2</b> GAM for classification problems</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2.2" data-path="lecture-notes.html"><a href="lecture-notes.html"><i class="fa fa-check"></i><b>2.2</b> Lecture notes</a></li>
<li class="chapter" data-level="2.3" data-path="lab-section.html"><a href="lab-section.html"><i class="fa fa-check"></i><b>2.3</b> Lab section</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="lab-section.html"><a href="lab-section.html#polynomial-regression-and-step-functions"><i class="fa fa-check"></i><b>2.3.1</b> Polynomial Regression and Step Functions</a>
<ul>
<li class="chapter" data-level="2.3.1.1" data-path="lab-section.html"><a href="lab-section.html#continous-model"><i class="fa fa-check"></i><b>2.3.1.1</b> Continous model</a></li>
<li class="chapter" data-level="2.3.1.2" data-path="lab-section.html"><a href="lab-section.html#logarithmic-model"><i class="fa fa-check"></i><b>2.3.1.2</b> Logarithmic model</a></li>
<li class="chapter" data-level="2.3.1.3" data-path="lab-section.html"><a href="lab-section.html#step-function"><i class="fa fa-check"></i><b>2.3.1.3</b> Step function</a></li>
</ul></li>
<li class="chapter" data-level="2.3.2" data-path="lab-section.html"><a href="lab-section.html#splines"><i class="fa fa-check"></i><b>2.3.2</b> Splines</a>
<ul>
<li class="chapter" data-level="2.3.2.1" data-path="lab-section.html"><a href="lab-section.html#basis-function-splines"><i class="fa fa-check"></i><b>2.3.2.1</b> Basis Function Splines</a></li>
<li class="chapter" data-level="2.3.2.2" data-path="lab-section.html"><a href="lab-section.html#natural-splines"><i class="fa fa-check"></i><b>2.3.2.2</b> Natural Splines</a></li>
<li class="chapter" data-level="2.3.2.3" data-path="lab-section.html"><a href="lab-section.html#smooth-splines"><i class="fa fa-check"></i><b>2.3.2.3</b> Smooth Splines</a></li>
<li class="chapter" data-level="2.3.2.4" data-path="lab-section.html"><a href="lab-section.html#local-regression-1"><i class="fa fa-check"></i><b>2.3.2.4</b> Local Regression</a></li>
</ul></li>
<li class="chapter" data-level="2.3.3" data-path="lab-section.html"><a href="lab-section.html#gams"><i class="fa fa-check"></i><b>2.3.3</b> GAMs</a>
<ul>
<li class="chapter" data-level="2.3.3.1" data-path="lab-section.html"><a href="lab-section.html#with-only-natural-splines"><i class="fa fa-check"></i><b>2.3.3.1</b> With only natural splines</a></li>
<li class="chapter" data-level="2.3.3.2" data-path="lab-section.html"><a href="lab-section.html#with-different-splines"><i class="fa fa-check"></i><b>2.3.3.2</b> With different splines</a></li>
<li class="chapter" data-level="2.3.3.3" data-path="lab-section.html"><a href="lab-section.html#but-what-variables-to-include"><i class="fa fa-check"></i><b>2.3.3.3</b> But what variables to include?</a></li>
<li class="chapter" data-level="2.3.3.4" data-path="lab-section.html"><a href="lab-section.html#gam-with-local-regression"><i class="fa fa-check"></i><b>2.3.3.4</b> GAM with local regression</a></li>
<li class="chapter" data-level="2.3.3.5" data-path="lab-section.html"><a href="lab-section.html#logistic-regression"><i class="fa fa-check"></i><b>2.3.3.5</b> Logistic Regression</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="exercises.html"><a href="exercises.html"><i class="fa fa-check"></i><b>2.4</b> Exercises</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="exercises.html"><a href="exercises.html#exercise-6"><i class="fa fa-check"></i><b>2.4.1</b> Exercise 6</a>
<ul>
<li class="chapter" data-level="2.4.1.1" data-path="exercises.html"><a href="exercises.html#a-polynomial-regression"><i class="fa fa-check"></i><b>2.4.1.1</b> 6.a Polynomial Regression</a></li>
<li class="chapter" data-level="2.4.1.2" data-path="exercises.html"><a href="exercises.html#b-step-function"><i class="fa fa-check"></i><b>2.4.1.2</b> 6.b Step function</a></li>
</ul></li>
<li class="chapter" data-level="2.4.2" data-path="exercises.html"><a href="exercises.html#exercise-7"><i class="fa fa-check"></i><b>2.4.2</b> Exercise 7</a></li>
<li class="chapter" data-level="2.4.3" data-path="exercises.html"><a href="exercises.html#exercise-8"><i class="fa fa-check"></i><b>2.4.3</b> Exercise 8</a></li>
<li class="chapter" data-level="2.4.4" data-path="exercises.html"><a href="exercises.html#exercise-9"><i class="fa fa-check"></i><b>2.4.4</b> Exercise 9</a></li>
<li class="chapter" data-level="2.4.5" data-path="exercises.html"><a href="exercises.html#exercise-10"><i class="fa fa-check"></i><b>2.4.5</b> Exercise 10</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="tree-based-methods.html"><a href="tree-based-methods.html"><i class="fa fa-check"></i><b>3</b> Tree Based Methods</a></li>
<li class="chapter" data-level="4" data-path="subject-1.html"><a href="subject-1.html"><i class="fa fa-check"></i><b>4</b> Subject 1</a></li>
<li class="chapter" data-level="5" data-path="subject-1-1.html"><a href="subject-1-1.html"><i class="fa fa-check"></i><b>5</b> Subject 1</a></li>
<li class="chapter" data-level="6" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i><b>6</b> References</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Machine Learning for Business Intelligence 2</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="exercises" class="section level2" number="2.4">
<h2><span class="header-section-number">2.4</span> Exercises</h2>
<div id="exercise-6" class="section level3" number="2.4.1">
<h3><span class="header-section-number">2.4.1</span> Exercise 6</h3>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb64-1"><a href="exercises.html#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ISLR)</span>
<span id="cb64-2"><a href="exercises.html#cb64-2" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> Wage</span></code></pre></div>
<div id="a-polynomial-regression" class="section level4" number="2.4.1.1">
<h4><span class="header-section-number">2.4.1.1</span> 6.a Polynomial Regression</h4>
<p>We use orthogonal polynomials in the modeling process as we know that these are slightly better than raw polynomials due to the fact that this tend to avoid collinearity.</p>
<p>Training the model</p>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb65-1"><a href="exercises.html#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(boot)</span>
<span id="cb65-2"><a href="exercises.html#cb65-2" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1337</span>)</span>
<span id="cb65-3"><a href="exercises.html#cb65-3" aria-hidden="true" tabindex="-1"></a>cv.error <span class="ot">=</span> <span class="fu">rep</span> (<span class="dv">0</span>,<span class="dv">5</span>)</span>
<span id="cb65-4"><a href="exercises.html#cb65-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">1</span>,<span class="at">to =</span> <span class="fu">length</span>(cv.error),<span class="at">by =</span> <span class="dv">1</span>)) {</span>
<span id="cb65-5"><a href="exercises.html#cb65-5" aria-hidden="true" tabindex="-1"></a>  <span class="co">#Training</span></span>
<span id="cb65-6"><a href="exercises.html#cb65-6" aria-hidden="true" tabindex="-1"></a>  fit.i <span class="ot">&lt;-</span> <span class="fu">glm</span>(wage <span class="sc">~</span> <span class="fu">poly</span>(age,i),<span class="at">data =</span> df)  <span class="co"># notice glm here in conjunction with cv.glm function</span></span>
<span id="cb65-7"><a href="exercises.html#cb65-7" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb65-8"><a href="exercises.html#cb65-8" aria-hidden="true" tabindex="-1"></a>  <span class="co">#Performing cross validation</span></span>
<span id="cb65-9"><a href="exercises.html#cb65-9" aria-hidden="true" tabindex="-1"></a>  cv.error[i] <span class="ot">&lt;-</span> <span class="fu">cv.glm</span>(<span class="at">data =</span> df,<span class="at">glmfit =</span> fit.i,<span class="at">K =</span> <span class="dv">10</span>)<span class="sc">$</span>delta[<span class="dv">1</span>] <span class="co">#K fold CV, delta = prediction error</span></span>
<span id="cb65-10"><a href="exercises.html#cb65-10" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb65-11"><a href="exercises.html#cb65-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-12"><a href="exercises.html#cb65-12" aria-hidden="true" tabindex="-1"></a><span class="co">#Printing the </span></span>
<span id="cb65-13"><a href="exercises.html#cb65-13" aria-hidden="true" tabindex="-1"></a>cv.error <span class="co"># the CV errors of the five polynomials models</span></span></code></pre></div>
<pre><code>## [1] 1675.056 1600.832 1594.505 1594.872 1594.608</code></pre>
<p>The vector above are all of the prediction errors computed in the loop.</p>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb67-1"><a href="exercises.html#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="fu">which.min</span>(cv.error)</span></code></pre></div>
<pre><code>## [1] 3</code></pre>
<p>We see that the fifth prediction appear to yield the lowest MSE, but is it significantly different than e.g. forth or third order polynomial?</p>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb69-1"><a href="exercises.html#cb69-1" aria-hidden="true" tabindex="-1"></a>fit<span class="fl">.1</span> <span class="ot">&lt;-</span> <span class="fu">glm</span>(wage <span class="sc">~</span> <span class="fu">poly</span>(age,<span class="dv">1</span>),<span class="at">data =</span> df) </span>
<span id="cb69-2"><a href="exercises.html#cb69-2" aria-hidden="true" tabindex="-1"></a>fit<span class="fl">.2</span> <span class="ot">&lt;-</span> <span class="fu">glm</span>(wage <span class="sc">~</span> <span class="fu">poly</span>(age,<span class="dv">2</span>),<span class="at">data =</span> df) </span>
<span id="cb69-3"><a href="exercises.html#cb69-3" aria-hidden="true" tabindex="-1"></a>fit<span class="fl">.3</span> <span class="ot">&lt;-</span> <span class="fu">glm</span>(wage <span class="sc">~</span> <span class="fu">poly</span>(age,<span class="dv">3</span>),<span class="at">data =</span> df) </span>
<span id="cb69-4"><a href="exercises.html#cb69-4" aria-hidden="true" tabindex="-1"></a>fit<span class="fl">.4</span> <span class="ot">&lt;-</span> <span class="fu">glm</span>(wage <span class="sc">~</span> <span class="fu">poly</span>(age,<span class="dv">4</span>),<span class="at">data =</span> df) </span>
<span id="cb69-5"><a href="exercises.html#cb69-5" aria-hidden="true" tabindex="-1"></a>fit<span class="fl">.5</span> <span class="ot">&lt;-</span> <span class="fu">glm</span>(wage <span class="sc">~</span> <span class="fu">poly</span>(age,<span class="dv">5</span>),<span class="at">data =</span> df) </span>
<span id="cb69-6"><a href="exercises.html#cb69-6" aria-hidden="true" tabindex="-1"></a><span class="fu">anova</span>(fit<span class="fl">.1</span>,fit<span class="fl">.2</span>,fit<span class="fl">.3</span>,fit<span class="fl">.4</span>,fit<span class="fl">.5</span>,<span class="at">test =</span> <span class="st">&quot;F&quot;</span>)</span></code></pre></div>
<div class="kable-table">
<table>
<thead>
<tr class="header">
<th align="right">Resid. Df</th>
<th align="right">Resid. Dev</th>
<th align="right">Df</th>
<th align="right">Deviance</th>
<th align="right">F</th>
<th align="right">Pr(&gt;F)</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="right">2998</td>
<td align="right">5022216</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
<td align="right">NA</td>
</tr>
<tr class="even">
<td align="right">2997</td>
<td align="right">4793430</td>
<td align="right">1</td>
<td align="right">228786.010</td>
<td align="right">143.5931074</td>
<td align="right">0.0000000</td>
</tr>
<tr class="odd">
<td align="right">2996</td>
<td align="right">4777674</td>
<td align="right">1</td>
<td align="right">15755.694</td>
<td align="right">9.8887559</td>
<td align="right">0.0016792</td>
</tr>
<tr class="even">
<td align="right">2995</td>
<td align="right">4771604</td>
<td align="right">1</td>
<td align="right">6070.152</td>
<td align="right">3.8098134</td>
<td align="right">0.0510462</td>
</tr>
<tr class="odd">
<td align="right">2994</td>
<td align="right">4770322</td>
<td align="right">1</td>
<td align="right">1282.563</td>
<td align="right">0.8049758</td>
<td align="right">0.3696820</td>
</tr>
</tbody>
</table>
</div>
<p>Using the F test, we see that on a five percent level the 4th ppolynomial is not justified, but close to.</p>
<p>Thus we select a model with three polynomials. Plotting the errors, we also see that there does not happen much after the thrid polynomial</p>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb70-1"><a href="exercises.html#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(cv.error,<span class="at">type =</span> <span class="st">&quot;b&quot;</span>)</span></code></pre></div>
<p><img src="Machine-Learning-Notes_files/figure-html/unnamed-chunk-55-1.png" width="720" style="display: block; margin: auto;" /></p>
<p><strong>Plotting the polynomial regression</strong></p>
<p>This is done with the following procedure:</p>
<ol style="list-style-type: decimal">
<li>Make a grid counting IDV (Age)</li>
<li>Make predictions</li>
<li>Make a plot with the variables</li>
<li>Fit a line onto the predictions</li>
<li>Perhaps calculate confidence levels and plot these</li>
</ol>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb71-1"><a href="exercises.html#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="co">#Grid of X</span></span>
<span id="cb71-2"><a href="exercises.html#cb71-2" aria-hidden="true" tabindex="-1"></a>age.grid <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="fu">min</span>(df<span class="sc">$</span>age),<span class="at">to =</span> <span class="fu">max</span>(df<span class="sc">$</span>age),<span class="at">by =</span> <span class="dv">1</span>)</span>
<span id="cb71-3"><a href="exercises.html#cb71-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-4"><a href="exercises.html#cb71-4" aria-hidden="true" tabindex="-1"></a><span class="co">#Predictions</span></span>
<span id="cb71-5"><a href="exercises.html#cb71-5" aria-hidden="true" tabindex="-1"></a>preds <span class="ot">&lt;-</span> <span class="fu">predict</span>(<span class="at">object =</span> fit<span class="fl">.3</span></span>
<span id="cb71-6"><a href="exercises.html#cb71-6" aria-hidden="true" tabindex="-1"></a>                 ,<span class="at">newdata =</span> <span class="fu">list</span>(<span class="at">age =</span> age.grid) <span class="co">#Renaming age.grid to age</span></span>
<span id="cb71-7"><a href="exercises.html#cb71-7" aria-hidden="true" tabindex="-1"></a>                 ,<span class="at">se.fit =</span> <span class="cn">TRUE</span>) <span class="co">#We want to produce confidence levels</span></span>
<span id="cb71-8"><a href="exercises.html#cb71-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-9"><a href="exercises.html#cb71-9" aria-hidden="true" tabindex="-1"></a><span class="co">#Plotting</span></span>
<span id="cb71-10"><a href="exercises.html#cb71-10" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="at">x =</span> df<span class="sc">$</span>age,<span class="at">y =</span> df<span class="sc">$</span>wage,<span class="at">col =</span> <span class="st">&quot;darkgrey&quot;</span>,<span class="at">cex =</span> <span class="fl">0.8</span>)</span>
<span id="cb71-11"><a href="exercises.html#cb71-11" aria-hidden="true" tabindex="-1"></a><span class="fu">grid</span>()</span>
<span id="cb71-12"><a href="exercises.html#cb71-12" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(<span class="at">x =</span> age.grid <span class="co">#We need to define the grid, otherwise the fit will not be alligned with the data</span></span>
<span id="cb71-13"><a href="exercises.html#cb71-13" aria-hidden="true" tabindex="-1"></a>      ,<span class="at">y =</span> preds<span class="sc">$</span>fit</span>
<span id="cb71-14"><a href="exercises.html#cb71-14" aria-hidden="true" tabindex="-1"></a>      ,<span class="at">col =</span> <span class="st">&quot;red&quot;</span>)</span>
<span id="cb71-15"><a href="exercises.html#cb71-15" aria-hidden="true" tabindex="-1"></a><span class="fu">title</span>(<span class="st">&quot;Polynomial of 3rd order&quot;</span>)</span></code></pre></div>
<p><img src="Machine-Learning-Notes_files/figure-html/unnamed-chunk-56-1.png" width="720" style="display: block; margin: auto;" /></p>
</div>
<div id="b-step-function" class="section level4" number="2.4.1.2">
<h4><span class="header-section-number">2.4.1.2</span> 6.b Step function</h4>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb72-1"><a href="exercises.html#cb72-1" aria-hidden="true" tabindex="-1"></a>cuts <span class="ot">&lt;-</span> <span class="dv">4</span></span>
<span id="cb72-2"><a href="exercises.html#cb72-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-3"><a href="exercises.html#cb72-3" aria-hidden="true" tabindex="-1"></a><span class="co">#Cutting the x variable</span></span>
<span id="cb72-4"><a href="exercises.html#cb72-4" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(<span class="fu">cut</span>(df<span class="sc">$</span>age</span>
<span id="cb72-5"><a href="exercises.html#cb72-5" aria-hidden="true" tabindex="-1"></a>          ,<span class="at">breaks =</span> cuts))</span></code></pre></div>
<pre><code>## 
## (17.9,33.5]   (33.5,49]   (49,64.5] (64.5,80.1] 
##         750        1399         779          72</code></pre>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb74-1"><a href="exercises.html#cb74-1" aria-hidden="true" tabindex="-1"></a>  <span class="co">#&#39; Note, this only shows where the cuts lie and how many there are in each</span></span>
<span id="cb74-2"><a href="exercises.html#cb74-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-3"><a href="exercises.html#cb74-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-4"><a href="exercises.html#cb74-4" aria-hidden="true" tabindex="-1"></a><span class="co">#Fitting the step function</span></span>
<span id="cb74-5"><a href="exercises.html#cb74-5" aria-hidden="true" tabindex="-1"></a>fit.step <span class="ot">&lt;-</span> <span class="fu">lm</span>(wage <span class="sc">~</span> <span class="fu">cut</span>(df<span class="sc">$</span>age,<span class="dv">4</span>)</span>
<span id="cb74-6"><a href="exercises.html#cb74-6" aria-hidden="true" tabindex="-1"></a>               ,<span class="at">data =</span> df)</span>
<span id="cb74-7"><a href="exercises.html#cb74-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-8"><a href="exercises.html#cb74-8" aria-hidden="true" tabindex="-1"></a><span class="fu">coef</span>(<span class="fu">summary</span>(fit.step))</span></code></pre></div>
<pre><code>##                            Estimate Std. Error   t value     Pr(&gt;|t|)
## (Intercept)               94.158392   1.476069 63.789970 0.000000e+00
## cut(df$age, 4)(33.5,49]   24.053491   1.829431 13.148074 1.982315e-38
## cut(df$age, 4)(49,64.5]   23.664559   2.067958 11.443444 1.040750e-29
## cut(df$age, 4)(64.5,80.1]  7.640592   4.987424  1.531972 1.256350e-01</code></pre>
<p>We see that the the first cut (bin with people up to 33,5) have been left out. That is because they are contained in the intercept.</p>
<p>Now we can fit the step function</p>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb76-1"><a href="exercises.html#cb76-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(stats)</span>
<span id="cb76-2"><a href="exercises.html#cb76-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-3"><a href="exercises.html#cb76-3" aria-hidden="true" tabindex="-1"></a><span class="co">#Predictions</span></span>
<span id="cb76-4"><a href="exercises.html#cb76-4" aria-hidden="true" tabindex="-1"></a>preds <span class="ot">&lt;-</span> <span class="fu">predict</span>(<span class="at">object =</span> fit.step</span>
<span id="cb76-5"><a href="exercises.html#cb76-5" aria-hidden="true" tabindex="-1"></a>                 ,<span class="at">newdata =</span> <span class="fu">list</span>(<span class="at">age =</span> age.grid)) <span class="co">#Renaming age.grid to age</span></span>
<span id="cb76-6"><a href="exercises.html#cb76-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-7"><a href="exercises.html#cb76-7" aria-hidden="true" tabindex="-1"></a><span class="co">#Plotting</span></span>
<span id="cb76-8"><a href="exercises.html#cb76-8" aria-hidden="true" tabindex="-1"></a><span class="co"># plot(x = df$age,y = df$wage,col = &quot;darkgrey&quot;,cex = 0.8)</span></span>
<span id="cb76-9"><a href="exercises.html#cb76-9" aria-hidden="true" tabindex="-1"></a><span class="co"># grid()</span></span>
<span id="cb76-10"><a href="exercises.html#cb76-10" aria-hidden="true" tabindex="-1"></a><span class="co"># lines(age.grid</span></span>
<span id="cb76-11"><a href="exercises.html#cb76-11" aria-hidden="true" tabindex="-1"></a><span class="co">#       ,preds</span></span>
<span id="cb76-12"><a href="exercises.html#cb76-12" aria-hidden="true" tabindex="-1"></a><span class="co">#       ,col = &quot;red&quot;)</span></span>
<span id="cb76-13"><a href="exercises.html#cb76-13" aria-hidden="true" tabindex="-1"></a><span class="co"># title(&quot;Step function of 3rd order&quot;)</span></span></code></pre></div>
<p>I need to check what she is doing, one could perhaps manually order the</p>
</div>
</div>
<div id="exercise-7" class="section level3" number="2.4.2">
<h3><span class="header-section-number">2.4.2</span> Exercise 7</h3>
<div class="sourceCode" id="cb77"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb77-1"><a href="exercises.html#cb77-1" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> Wage</span></code></pre></div>
<p>Evaluating features other features to see how age respond hereon.</p>
<p>We can plot the variables agains each other, to see how they interact.</p>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb78-1"><a href="exercises.html#cb78-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>) {</span>
<span id="cb78-2"><a href="exercises.html#cb78-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>(<span class="at">y =</span> df<span class="sc">$</span>wage,<span class="at">x =</span> df[,i],<span class="at">xlab =</span> <span class="fu">names</span>(df)[i],<span class="at">ylab =</span> <span class="st">&quot;Wage&quot;</span>)</span>
<span id="cb78-3"><a href="exercises.html#cb78-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">grid</span>()</span>
<span id="cb78-4"><a href="exercises.html#cb78-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">names</span>(df)[i] <span class="sc">%&gt;%</span> <span class="fu">title</span>()</span>
<span id="cb78-5"><a href="exercises.html#cb78-5" aria-hidden="true" tabindex="-1"></a>}</span></code></pre></div>
<p><img src="Machine-Learning-Notes_files/figure-html/unnamed-chunk-61-1.png" width="720" style="display: block; margin: auto;" /><img src="Machine-Learning-Notes_files/figure-html/unnamed-chunk-61-2.png" width="720" style="display: block; margin: auto;" /><img src="Machine-Learning-Notes_files/figure-html/unnamed-chunk-61-3.png" width="720" style="display: block; margin: auto;" /><img src="Machine-Learning-Notes_files/figure-html/unnamed-chunk-61-4.png" width="720" style="display: block; margin: auto;" /><img src="Machine-Learning-Notes_files/figure-html/unnamed-chunk-61-5.png" width="720" style="display: block; margin: auto;" /><img src="Machine-Learning-Notes_files/figure-html/unnamed-chunk-61-6.png" width="720" style="display: block; margin: auto;" /><img src="Machine-Learning-Notes_files/figure-html/unnamed-chunk-61-7.png" width="720" style="display: block; margin: auto;" /><img src="Machine-Learning-Notes_files/figure-html/unnamed-chunk-61-8.png" width="720" style="display: block; margin: auto;" /><img src="Machine-Learning-Notes_files/figure-html/unnamed-chunk-61-9.png" width="720" style="display: block; margin: auto;" /><img src="Machine-Learning-Notes_files/figure-html/unnamed-chunk-61-10.png" width="720" style="display: block; margin: auto;" /></p>
<p>Looking at race, it appears as if there is some relationship between race and wage the same with maritial status. Region only has values in one category, jobclass appear to visually have different means. The same goes for health and health insurance. Naturall log of wage has a non linear relationship with wage. Although the variable is the same, thus it cant be used for much to predict wage levels.</p>
<p>Since all the variables of interest, and we haven’t worked with are all categorical, then we can’t really do any polynomial regression with the data, as they are all factors.</p>
<p>What one could do is a mutlivariate linear model with different factors, or step functions or perhaps GAM where a continous varaible with polynomials are included.</p>
<p>Therefore, I will not elaborate much more on this.</p>
</div>
<div id="exercise-8" class="section level3" number="2.4.3">
<h3><span class="header-section-number">2.4.3</span> Exercise 8</h3>
</div>
<div id="exercise-9" class="section level3" number="2.4.4">
<h3><span class="header-section-number">2.4.4</span> Exercise 9</h3>
</div>
<div id="exercise-10" class="section level3" number="2.4.5">
<h3><span class="header-section-number">2.4.5</span> Exercise 10</h3>

</div>
</div>
<!-- </div> -->
            </section>

          </div>
        </div>
      </div>
<a href="lab-section.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="tree-based-methods.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": null,
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
